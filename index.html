<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Web Workers: I like the way you work it</title>

		<meta name="description" content="I like the way you work it: all about Web Workers">
		<meta name="author" content="Nolan Lawson">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/simple.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<link rel="stylesheet" href="index.css">

		<!-- If the query includes 'print-pdf', include the PDF print sheet -->
		<script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = 'css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">
			<div class="slides">
				<section>
          <h2>Web Workers</h2>
          <h4>I like the way you work it</h4>
          <div class="pixel-image" style="width:300px;height:200px;background-image: url(img/worker_kirby.png);"></div>

          <div class="footer">
            <div class="text-muted">Speaker notes are in the dev console!</div>
          </div>
          <aside class="notes">
            Hi everybody.
          </aside>
        </section>

        <section>
          <h4>@nolanlawson</h4>
          <div><img class="no-border" src="img/me.jpg" alt="photo of Nolan Lawson"/></div>

          <aside class="notes">
            I'm Nolan Lawson. Sometimes I make "here's how big of a sub sandwich I had for lunch" hands, or as Mariko taught me they're called in Japanese, "pottery hands" (ろくろ回す手).
          </aside>
        </section>

        <section>
          <h4>I work on</h4>
          <img class="no-border" style="display:inline-block" height="150" src="img/squarespace.jpg" alt="squarespace"/>
          <img class="no-border" style="display:inline-block" height="150" src="img/pouchdb.png" alt="pouchdb"/>
          <aside class="notes">
            I also work at Squarespace, and I help maintain PouchDB.
          </aside>
        </section>

        <section>
          <h3>The web has a problem :(</h3>
          <aside class="notes">
            I have to start us off on kind of a dour note, by pointing out that
            the web has a problem. It's not a new problem – it's actually
            been around since the beginning of the web, but it's an interesting problem,
            and it's going to motivate the rest of my talk.
          </aside>
        </section>

        <section>
          <div>
            <video height=680 src="vid/kirby_blocked.webm" loop data-autoplay></video>
          </div>
          <aside class="notes">
            This problem is pretty easy to reproduce. All you need to do is
            make a web page with an animated gif - just a simple web page!

            Then fire up your dev console and enter some long-running JavaScript
            operation, like this loop. What you'll notice is that the GIF is
            blocked for the entirety of the loop.

            You can reproduce this in all the browser, by the way: Chrome, Firefox,
            Safari, and IE.
          </aside>
        </section>

        <section>
          <div>
            <video height=680 src="vid/kirby_form.webm" loop data-autoplay></video>
          </div>
          <aside class="notes">
            But it doesn't just affect animated GIFs - it affects almost everything
            on your page that moves. HTML5 video, JavaScript animations, CSS animations
            (except for hardware-accelerated ones) will all be stopped.

            In fact, it's worse than that - any form elements on the page will be
            non-interactive as well. Note that I can't click on any checkboxes or
            buttons while this is running.
          </aside>
        </section>

        <section>
          <h3>JS is single-threaded</h3>
          <aside class="notes">
            Of course, the reason for this is that JavaScript is single-threaded,
            and the browser environment (i.e. the DOM) is single-threaded. So while
            JavaScript is running, the browser can't do anything else.
          </aside>
        </section>

        <section>
          <h3>Every line of JS you've ever written has (momentarily) stopped your page from working.</h3>
          <aside class="notes">
            That's kind of a mind-blowing thought, right? It means that every line of JavaScript you've ever written has (momentarily) stopped your page from working. (Frontend JavaScript, anyway.)
          </aside>
        </section>

        <section>
          <div>
            <video height=680 src="vid/kirby_jank.webm" loop data-autoplay></video>
          </div>
          <aside class="notes">
            Now, you might not have ever written *such* a long-running JavaScript operation
            that you blocked the page entirely. But have you ever made or seen a page that looked like this?

            It's functional, but it feels kinda... off. I can interact with the page, but occasionally
            the scrolling locks up, and the animations might briefly jerk for a few split-seconds. It works, but
            it doesn't feel *good*.

            Now, this isn't due to one big long-running operation - this is due to lots of little operations
            that add up over time. It's death by a thousand cuts.

            Why does this happen? Well, we can explain with MATH!
          </aside>
        </section>

        <section>
          <h3>60 frames per second (FPS)</h3>
          <div>
            <img class="no-border" src="img/flipbook.gif"/>
          </div>
          <aside class="notes">
            Most monitors will refresh at 60 frames per second. What that means is that,
            every second, they flash an image 60 times, which gives the illusion of movement. It's just
            like this flipbook.
          </aside>
        </section>

        <section>
          <h3>1000ms / 60 frames = 16.7ms</h3>
        </section>

        <section>
          <h3>Factor in browser overhead...</h3>
          <img class="no-border"  src="img/paul_lewis.png" alt="Paul Lewis, 10ms"/>
        </section>

        <section>
          <img src="img/jeff_atwood.png" alt="Jeff Atwood, state of JS performance is poor"/>
        </section>

        <section>
          <h3>UI thread (main thread)</h3>
          <img class="no-border pixel-image" height="400" style="transform: translateY(20px)" src="img/kirby_paint.gif"/>
        </section>

        <section>
          <h3>Four cores</h3>
          <div class="quad-outer" style="transform: translateY(-30px)">
            <div  class="quad-inner">
              <img class="no-border pixel-image" style="transform: translate(0, 45px);" height="200" src="img/kirby_paint.gif"/>
              <img class="no-border pixel-image" style="transform: translate(40px, 45px);" height="240" src="img/kirby_fight.gif"/>
            </div>
            <div  class="quad-inner">
              <img class="no-border pixel-image" height="120" src="img/kirby_spin_dance.gif"/>
              <img class="no-border pixel-image"  style="transform: translate(0, 5px);"height="200" src="img/kirby_run.gif"/>
            </div>
          </div>
        </section>

        <section>
          <h3>Most webapps</h3>
          <div class="quad-outer" style="transform: translateY(-30px)">
            <div  class="quad-inner">
              <div style="width:200px;height:200px;background: url(img/kirby_busy.gif) no-repeat;background-size: 150%;background-position: -50px 10px;" class="no-border pixel-image"></div>
              <img class="no-border pixel-image" style="transform: translate(0, 65px);"height="200" src="img/kirby_sleep.gif"/>
            </div>
            <div class="quad-inner">
              <img class="no-border pixel-image" style="transform: translate(0, 65px);"height="200" src="img/kirby_sleep.gif"/>
              <img class="no-border pixel-image" style="transform: translate(0, 65px);"height="200" src="img/kirby_sleep.gif"/>
            </div>
          </div>
        </section>

        <section>
          <img class="no-border pixel-image" style="display:block" width="100" src="img/kirby_expedition.gif"/>
          <h4>http://nolanlawson.github.io/brooklynjs-2016-02/</h4>
          <ul>
            <li><a href="demo1.html">First demo</a></li>
            <li><a href="demo2.html">Second demo</a></li>
          </ul>
        </section>

      </div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>
		<script src="js/jquery-1.9.1.js"></script>
		<script src="js/highcharts.js"></script>
		<script src="js/highcharts-exporting.js"></script>
    <script src="js/ua.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,
        fragments: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'linear', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});

      Reveal.addEventListener( 'slidechanged', function( event ) {
        // event.previousSlide, event.currentSlide, event.indexh, event.indexv
        var notes = event.currentSlide.querySelector(".notes");
        if(notes) {
          console.info(notes.innerHTML.replace(/\n\s+/g,'\n'));
        }
      } );

      Reveal.addEventListener('fragmentshown', function (e) {
        // show the animations
        $(e.target).find('li span').each(function (i, el) {
          $(el).addClass('anim' + (i + 1));
        });
      });

      Reveal.addEventListener('fragmenthidden', function (e) {
        // hide the animations
        $(e.target).find('li span').each(function (i, el) {
          $(el).removeClass('anim' + (i + 1));
        });
      });

      // log the first slide's notes as well
      var notes = document.querySelector('section.present aside.notes');
      if (notes) {
        console.info(notes.innerHTML.replace(/\n\s+/g, '\n'));
      }

      if (!UA.isChrome() && !UA.isFirefox() && !UA.isAndroid() && !UA.isOpera()) {
        window.alert(
          'Heads up! This presentation looks best in ' +
          'Firefox/Chrome due to WEBM video and image-rendering:pixelated. Sorry!');
      }
    </script>

	</body>
</html>
